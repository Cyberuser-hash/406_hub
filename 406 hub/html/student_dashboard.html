<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Панель студента - 406 Hub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f5f7fa; min-height: 100vh; }
        
        /* Header */
        .header { 
            background: white; 
            padding: 20px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            margin-bottom: 20px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }
        .welcome { 
            font-size: 24px; 
            font-weight: 600; 
            color: #333; 
        }
        .header-actions { 
            display: flex; 
            gap: 10px; 
            align-items: center; 
        }
        .btn { 
            padding: 10px 20px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600; 
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .btn-primary { background: #667eea; color: white; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-info { background: #17a2b8; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
        
        /* Статистика */
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 20px; 
            margin-bottom: 30px; 
        }
        .stat-card { 
            background: white; 
            padding: 25px; 
            border-radius: 15px; 
            box-shadow: 0 3px 15px rgba(0,0,0,0.1); 
            text-align: center;
            transition: transform 0.3s ease;
        }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-number { 
            font-size: 32px; 
            font-weight: 700; 
            color: #667eea; 
            margin-bottom: 5px; 
        }
        .stat-label { 
            font-size: 14px; 
            color: #666; 
        }
        .stat-icon { 
            font-size: 24px; 
            color: #667eea; 
            margin-bottom: 10px; 
        }
        
        /* Основной контент */
        .content-grid { 
            display: grid; 
            grid-template-columns: 2fr 1fr; 
            gap: 20px; 
            margin-bottom: 30px;
        }
        .section { 
            background: white; 
            padding: 25px; 
            border-radius: 15px; 
            box-shadow: 0 3px 15px rgba(0,0,0,0.1); 
        }
        .section-title { 
            font-size: 20px; 
            font-weight: 600; 
            margin-bottom: 20px; 
            color: #333; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        /* Сетка курсов */
        .courses-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); 
            gap: 20px; 
        }
        .course-card { 
            background: white; 
            border-radius: 15px; 
            overflow: hidden; 
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .course-card:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #667eea;
        }
        .course-image { 
            height: 160px; 
            background: linear-gradient(135deg, #667eea, #764ba2); 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 48px; 
            position: relative;
            overflow: hidden;
        }
        .course-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            backdrop-filter: blur(10px);
        }
        .course-content { padding: 20px; }
        .course-title { 
            font-size: 18px; 
            font-weight: 600; 
            margin-bottom: 10px; 
            color: #333; 
            line-height: 1.3;
        }
        .course-description { 
            color: #666; 
            margin-bottom: 15px; 
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .course-stats { 
            display: flex; 
            justify-content: space-between; 
            color: #888; 
            font-size: 14px; 
            margin-bottom: 15px; 
        }
        .progress-container { margin: 15px 0; }
        .progress-bar { 
            width: 100%; 
            height: 8px; 
            background: #e9ecef; 
            border-radius: 4px; 
            overflow: hidden; 
            margin-bottom: 5px;
        }
        .progress-fill { 
            height: 100%; 
            background: linear-gradient(90deg, #667eea, #764ba2); 
            border-radius: 4px; 
            transition: width 0.5s ease; 
            position: relative;
        }
        .progress-text { 
            display: flex; 
            justify-content: space-between; 
            font-size: 12px; 
            color: #666; 
        }
        
        /* Боковая панель */
        .quick-actions { 
            display: flex; 
            flex-direction: column; 
            gap: 12px; 
            margin-bottom: 25px;
        }
        .action-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #333;
        }
        .action-item:hover {
            background: #667eea;
            color: white;
            transform: translateX(5px);
        }
        .action-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }
        
        /* Уведомления */
        .notifications-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .notification-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }
        .notification-item:last-child {
            border-bottom: none;
        }
        .notification-icon {
            font-size: 16px;
            color: #667eea;
            margin-top: 2px;
        }
        .notification-content {
            flex: 1;
        }
        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        .notification-message {
            color: #666;
            font-size: 14px;
            line-height: 1.4;
        }
        .notification-time {
            color: #999;
            font-size: 12px;
        }
        
        /* Мои задания виджет */
        .assignments-widget {
            margin-top: 20px;
        }
        .assignment-category {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .category-name {
            font-weight: 600;
            color: #333;
        }
        .assignments-count {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        .assignment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        .assignment-item:last-child {
            border-bottom: none;
        }
        .assignment-info {
            flex: 1;
        }
        .assignment-name {
            font-weight: 500;
            font-size: 14px;
            color: #333;
        }
        .assignment-meta {
            font-size: 12px;
            color: #666;
        }
        
        /* Срочные задания */
        .urgent-assignments {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
        }
        .assignment-urgent {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
        }
        
        /* Адаптивность */
        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            .courses-grid {
                grid-template-columns: 1fr;
            }
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            .header-actions {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
        
        /* Анимации */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        /* Загрузка */
        .loading { 
            text-align: center; 
            padding: 40px; 
            color: #666; 
        }
        .loading-spinner {
            font-size: 48px;
            color: #667eea;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="welcome" id="welcomeText">Панель студента</div>
        <div class="header-actions">
            <!-- ОСНОВНАЯ ССЫЛКА НА ЗАДАНИЯ -->
            <a href="student_materials.html" class="btn btn-success">
                <i class="fas fa-tasks"></i> Мои задания
            </a>
            <a href="student_profile.html" class="btn btn-info">
                <i class="fas fa-user"></i> Профиль
            </a>
            <a href="student_grades.html" class="btn btn-warning">
                <i class="fas fa-chart-line"></i> Успеваемость
            </a>
            <button class="btn btn-danger" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Выйти
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Статистика -->
        <div class="stats-grid" id="statsContainer">
            <div class="stat-card fade-in">
                <div class="stat-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <div class="stat-number" id="totalCourses">0</div>
                <div class="stat-label">Активных курсов</div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <div class="stat-number" id="totalAssignments">0</div>
                <div class="stat-label">Всего заданий</div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-number" id="completedAssignments">0</div>
                <div class="stat-label">Выполнено</div>
            </div>
            <div class="stat-card fade-in">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-number" id="pendingAssignments">0</div>
                <div class="stat-label">Ожидают сдачи</div>
            </div>
        </div>

        <!-- Основной контент -->
        <div class="content-grid">
            <!-- Левая колонка: Курсы -->
            <div class="section">
                <div class="section-title">
                    <span>Мои курсы</span>
                    <div>
                        <button class="btn btn-primary btn-sm" onclick="loadCourses()">
                            <i class="fas fa-sync-alt"></i> Обновить
                        </button>
                    </div>
                </div>
                <div class="courses-grid" id="coursesContainer">
                    <div class="loading">
                        <div class="loading-spinner">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                        <p>Загрузка курсов...</p>
                    </div>
                </div>
            </div>

            <!-- Правая колонка: Боковая панель -->
            <div class="section">
                <!-- Быстрые действия -->
                <div class="section-title">Быстрые действия</div>
                <div class="quick-actions">
                    <!-- ССЫЛКА НА ЗАДАНИЯ В БЫСТРЫХ ДЕЙСТВИЯХ -->
                    <a href="student_materials.html" class="action-item">
                        <div class="action-icon">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <div>Мои задания</div>
                    </a>
                    <a href="student_deadlines.html" class="action-item">
                        <div class="action-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div>Ближайшие дедлайны</div>
                    </a>
                    <a href="student_messages.html" class="action-item">
                        <div class="action-icon">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div>Сообщения</div>
                    </a>
                    <a href="student_grades.html" class="action-item">
                        <div class="action-icon">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <div>Статистика успеваемости</div>
                    </a>
                </div>

                <!-- Последние задания -->
                <div class="section-title" style="margin-top: 25px;">Последние задания</div>
                <div class="assignments-widget" id="assignmentsWidget">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i> Загрузка заданий...
                    </div>
                </div>

                <!-- Срочные задания -->
                <div class="section-title" style="margin-top: 25px;">Срочные задания</div>
                <div class="notifications-list" id="urgentAssignments">
                    <div class="notification-item assignment-urgent">
                        <div class="notification-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="notification-content">
                            <div class="notification-title">Загрузка...</div>
                            <div class="notification-message">Проверяем срочные задания</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ближайшие дедлайны -->
        <div class="section">
            <div class="section-title">
                <span>Ближайшие дедлайны</span>
                <a href="student_deadlines.html" class="btn btn-primary btn-sm">
                    <i class="fas fa-list"></i> Все дедлайны
                </a>
            </div>
            <div id="deadlinesContainer">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Загрузка дедлайнов...
                </div>
            </div>
        </div>

        <!-- Виджет заданий -->
        <div class="section">
            <div class="section-title">
                <span>Мои задания по категориям</span>
                <a href="student_materials.html" class="btn btn-primary btn-sm">
                    <i class="fas fa-external-link-alt"></i> Все задания
                </a>
            </div>
            <div id="categoriesWidget">
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Загрузка категорий...
                </div>
            </div>
        </div>
    </div>

    <script>
        const user = JSON.parse(localStorage.getItem('user'));
        
        if (!user) {
            window.location.href = 'login.html';
        }

        document.getElementById('welcomeText').textContent = `Панель студента, ${user.login}!`;
        
        // Загрузка данных при открытии
        document.addEventListener('DOMContentLoaded', function() {
            loadCourses();
            loadStats();
            loadAssignmentsWidget();
            loadCategoriesWidget();
            loadUrgentAssignments();
            loadDeadlines();
        });

        // Загрузка курсов
        async function loadCourses() {
            try {
                const response = await fetch('handlers/get_student_courses.php?student_id=' + user.id);
                const result = await response.json();
                
                if (result.success) {
                    displayCourses(result.data);
                    updateStats(result.data);
                } else {
                    showNoCourses();
                }
            } catch (error) {
                console.error('Ошибка:', error);
                showNoCourses();
            }
        }

        // Отображение курсов
        function displayCourses(courses) {
            const container = document.getElementById('coursesContainer');
            
            if (courses.length === 0) {
                showNoCourses();
                return;
            }

            container.innerHTML = courses.map(course => {
                const progress = course.progress || 0;
                const progressColor = progress >= 80 ? '#28a745' : progress >= 50 ? '#ffc107' : '#dc3545';
                
                return `
                <div class="course-card fade-in">
                    <div class="course-image">
                        <i class="fas fa-graduation-cap"></i>
                        <div class="course-badge">
                            ${course.modules_count || 0} модулей
                        </div>
                    </div>
                    <div class="course-content">
                        <div class="course-title">${course.title}</div>
                        <div class="course-description">${course.description || 'Описание курса отсутствует'}</div>
                        <div class="course-stats">
                            <span><i class="fas fa-book"></i> ${course.modules_count || 0} модулей</span>
                            <span><i class="fas fa-tasks"></i> ${course.assignments_count || 0} заданий</span>
                        </div>
                        <div class="progress-container">
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${progress}%; background: ${progressColor};"></div>
                            </div>
                            <div class="progress-text">
                                <span>Прогресс</span>
                                <span>${progress}%</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="openCourse(${course.id})" style="width: 100%;">
                            <i class="fas fa-arrow-right"></i> Перейти к курсу
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        // Загрузка виджета заданий
        async function loadAssignmentsWidget() {
            try {
                const response = await fetch('handlers/get_student_materials.php');
                const result = await response.json();
                
                const container = document.getElementById('assignmentsWidget');
                if (result.success && result.data.length > 0) {
                    // Берем первые 3 задания из всех категорий
                    let allAssignments = [];
                    result.data.forEach(category => {
                        if (category.files && category.files.length > 0) {
                            category.files.slice(0, 2).forEach(file => {
                                allAssignments.push({
                                    ...file,
                                    categoryName: category.name
                                });
                            });
                        }
                    });
                    
                    allAssignments = allAssignments.slice(0, 3);
                    
                    if (allAssignments.length > 0) {
                        container.innerHTML = allAssignments.map(assignment => `
                            <div class="notification-item">
                                <div class="notification-icon">
                                    <i class="fas fa-file"></i>
                                </div>
                                <div class="notification-content">
                                    <div class="notification-title">${assignment.title}</div>
                                    <div class="notification-message">
                                        Категория: ${assignment.categoryName}
                                    </div>
                                    <div class="notification-time">
                                        ${new Date(assignment.uploaded_at).toLocaleDateString('ru-RU')}
                                    </div>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        container.innerHTML = `
                            <div class="notification-item">
                                <div class="notification-icon">
                                    <i class="fas fa-folder-open"></i>
                                </div>
                                <div class="notification-content">
                                    <div class="notification-title">Нет заданий</div>
                                    <div class="notification-message">Ожидайте назначения заданий от преподавателя</div>
                                </div>
                            </div>
                        `;
                    }
                } else {
                    container.innerHTML = `
                        <div class="notification-item">
                            <div class="notification-icon">
                                <i class="fas fa-folder-open"></i>
                            </div>
                            <div class="notification-content">
                                <div class="notification-title">Нет заданий</div>
                                <div class="notification-message">Ожидайте назначения заданий от преподавателя</div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Ошибка загрузки заданий:', error);
            }
        }

        // Загрузка виджета категорий
        async function loadCategoriesWidget() {
            try {
                const response = await fetch('handlers/get_student_materials.php');
                const result = await response.json();
                
                const container = document.getElementById('categoriesWidget');
                if (result.success && result.data.length > 0) {
                    container.innerHTML = result.data.map(category => {
                        const filesCount = category.files ? category.files.length : 0;
                        return `
                            <div class="assignment-category">
                                <div class="category-header">
                                    <div class="category-name">${category.name}</div>
                                    <div class="assignments-count">${filesCount}</div>
                                </div>
                                <div class="category-description" style="color: #666; font-size: 14px; margin-bottom: 10px;">
                                    ${category.description || 'Описание отсутствует'}
                                </div>
                                ${filesCount > 0 ? 
                                    category.files.slice(0, 3).map(file => `
                                        <div class="assignment-item">
                                            <div class="assignment-info">
                                                <div class="assignment-name">${file.title}</div>
                                                <div class="assignment-meta">
                                                    ${formatFileSize(file.file_size)} • ${new Date(file.uploaded_at).toLocaleDateString('ru-RU')}
                                                </div>
                                            </div>
                                            <button class="btn btn-info btn-sm" onclick="downloadFile(${file.id})">
                                                <i class="fas fa-download"></i>
                                            </button>
                                        </div>
                                    `).join('') : 
                                    '<div style="text-align: center; padding: 10px; color: #999; font-style: italic;">Задания отсутствуют</div>'
                                }
                                ${filesCount > 3 ? `
                                    <div style="text-align: center; margin-top: 10px;">
                                        <a href="student_materials.html" class="btn btn-outline-primary btn-sm">
                                            + еще ${filesCount - 3} заданий
                                        </a>
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    }).join('');
                } else {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-folder-open" style="font-size: 64px; margin-bottom: 15px;"></i>
                            <h3>Нет доступных категорий</h3>
                            <p>Ожидайте назначения категорий от преподавателя</p>
                            <a href="student_materials.html" class="btn btn-primary" style="margin-top: 15px;">
                                Проверить задания
                            </a>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Ошибка загрузки категорий:', error);
            }
        }

        // Обновление статистики
        function updateStats(courses) {
            const totalCourses = courses.length;
            let totalAssignments = 0;
            let completedAssignments = 0;
            let pendingAssignments = 0;

            courses.forEach(course => {
                totalAssignments += course.assignments_count || 0;
                completedAssignments += course.completed_assignments || 0;
                pendingAssignments += (course.assignments_count || 0) - (course.completed_assignments || 0);
            });

            document.getElementById('totalCourses').textContent = totalCourses;
            document.getElementById('totalAssignments').textContent = totalAssignments;
            document.getElementById('completedAssignments').textContent = completedAssignments;
            document.getElementById('pendingAssignments').textContent = pendingAssignments;
        }

        // Загрузка статистики
        async function loadStats() {
            try {
                const response = await fetch(`handlers/get_student_stats.php?student_id=${user.id}`);
                const result = await response.json();
                
                if (result.success) {
                    // Статистика уже обновлена в updateStats
                }
            } catch (error) {
                console.error('Ошибка загрузки статистики:', error);
            }
        }

        // Загрузка срочных заданий
        async function loadUrgentAssignments() {
            try {
                // Заглушка для срочных заданий
                const container = document.getElementById('urgentAssignments');
                container.innerHTML = `
                    <div class="notification-item">
                        <div class="notification-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="notification-content">
                            <div class="notification-title">Нет срочных заданий</div>
                            <div class="notification-message">Все задания выполнены вовремя</div>
                        </div>
                    </div>
                `;
            } catch (error) {
                console.error('Ошибка загрузки срочных заданий:', error);
            }
        }

        // Загрузка дедлайнов
        async function loadDeadlines() {
            try {
                // Заглушка для дедлайнов
                const container = document.getElementById('deadlinesContainer');
                container.innerHTML = `
                    <div style="text-align: center; padding: 30px; color: #666;">
                        <i class="fas fa-calendar-check" style="font-size: 48px; margin-bottom: 15px;"></i>
                        <div>Нет предстоящих дедлайнов</div>
                    </div>
                `;
            } catch (error) {
                console.error('Ошибка загрузки дедлайнов:', error);
            }
        }

        // Скачивание файла
        async function downloadFile(fileId) {
            try {
                const response = await fetch(`handlers/teacher_download_file.php?file_id=${fileId}`);
                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    
                    const contentDisposition = response.headers.get('Content-Disposition');
                    let filename = 'file';
                    if (contentDisposition) {
                        const filenameMatch = contentDisposition.match(/filename="(.+)"/);
                        if (filenameMatch) {
                            filename = filenameMatch[1];
                        }
                    }
                    
                    a.download = filename;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                } else {
                    alert('Ошибка при скачивании задания');
                }
            } catch (error) {
                alert('Ошибка при скачивании задания');
            }
        }

        // Вспомогательные функции
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function showNoCourses() {
            document.getElementById('coursesContainer').innerHTML = `
                <div class="no-courses" style="grid-column: 1 / -1; text-align: center; padding: 60px 20px; color: #666;">
                    <i class="fas fa-book" style="font-size: 64px; margin-bottom: 20px;"></i>
                    <h3>Курсы не назначены</h3>
                    <p>Обратитесь к преподавателю для назначения курсов</p>
                    <button class="btn btn-primary" onclick="loadCourses()" style="margin-top: 20px;">
                        <i class="fas fa-sync-alt"></i> Обновить
                    </button>
                </div>
            `;
        }

        function openCourse(courseId) {
            window.location.href = `course_student.html?course_id=${courseId}`;
        }

        function logout() {
            localStorage.removeItem('user');
            window.location.href = 'login.html';
        }

        // Автообновление каждые 5 минут
        setInterval(() => {
            loadAssignmentsWidget();
            loadCategoriesWidget();
        }, 5 * 60 * 1000);
    </script>
</body>
</html>
